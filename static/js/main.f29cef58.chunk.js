(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{134:function(e,t,a){e.exports=a(214)},213:function(e,t,a){},214:function(e,t,a){"use strict";a.r(t);var n=a(12),r=a(13),l=a(15),o=a(14),c=a(16),i=a(0),s=a.n(i),u=a(4),m=a.n(u),p=a(215),h=a(216),d=(a(82),p.a),f=function(e){function t(){return Object(n.a)(this,t),Object(l.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return s.a.createElement(d,{id:"foot",style:{textAlign:"center",color:"gray"}},s.a.createElement(h.a,null,s.a.createElement("span",{id:"footer"},"Movie List \xa92019 Created by Mingfeng Ou")))}}]),t}(i.Component),E=a(217),b=a(67),v=p.a,y=E.a.Search,g=b.a.Option,O="title",j=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(l.a)(this,Object(o.a)(t).call(this))).state={searchType:"title"},e}return Object(c.a)(t,e),Object(r.a)(t,[{key:"handleSearch",value:function(e){if(this.props.onSubmit&&null!=e&&""!==e){var t=e;this.props.onSubmit(t,O)}}},{key:"handleChange",value:function(e){O=e}},{key:"render",value:function(){var e=this,t=s.a.createElement(b.a,{defaultValue:"\u6309\u6807\u9898",style:{width:100},onChange:this.handleChange},s.a.createElement(g,{value:"title"},"\u6309\u6807\u9898"),s.a.createElement(g,{value:"summary"},"\u6309\u7b80\u4ecb"),s.a.createElement(g,{value:"actor"},"\u6309\u6f14\u5458"),s.a.createElement(g,{value:"time"},"\u6309\u65f6\u95f4"));return s.a.createElement(v,null,s.a.createElement("div",{className:"logo"}),s.a.createElement("p",{class:"pageTitle"},"\u7535\u5f71\u5217\u8868"),s.a.createElement("div",null,s.a.createElement(y,{addonBefore:t,placeholder:"\u8bf7\u8f93\u5165\u641c\u7d22\u5173\u952e\u5b57",enterButton:"Search",size:"large",onSearch:function(t){return e.handleSearch(t)}})))}}]),t}(i.Component),k=a(60),S=a(218),C=a(219),w=a(131),P=a(41),L=a(69),N=function(e){return function(t){fetch(e).then(function(e){return e.json()}).then(function(e){return t({type:"GET_DATA",itemList:D(e.list),total:e.total})})}},D=function(e){var t=!0,a=!1,n=void 0;try{for(var r,l=e[Symbol.iterator]();!(t=(r=l.next()).done);t=!0){var o=r.value;o.rating=JSON.parse(o.rating),o.genres=JSON.parse(o.genres),o.countries=JSON.parse(o.countries),o.casts=JSON.parse(o.casts),o.directors=JSON.parse(o.directors),o.pubdate=JSON.parse(o.pubdate)}}catch(c){a=!0,n=c}finally{try{t||null==l.return||l.return()}finally{if(a)throw n}}return e},T=a(35),M=function(e){function t(e){var a;return Object(n.a)(this,t),console.log("movie list constructor"),a=Object(l.a)(this,Object(o.a)(t).call(this,e)),console.log(a.props.path),a.state={basicPath:a.props.basicPath},a.onPageChange=a.onPageChange.bind(Object(k.a)(Object(k.a)(a))),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentWillMount",value:function(){console.log("movie list componentWillMount"),console.log(typeof this.props.basicPath);var e=this.props.basicPath+this.props.pageNum;console.log(e);var t=new Request(e,{method:"GET"});this.props.fetchData(t)}},{key:"shouldComponentUpdate",value:function(e,t,a){return!0}},{key:"onPageChange",value:function(e){console.info("getData");var t=new Request(this.props.basicPath+e,{method:"GET"});this.props.changePage(e),this.props.fetchData(t)}},{key:"componentWillUnmount",value:function(){console.log("movie list componentWillUnmount")}},{key:"render",value:function(){console.log("movielist render");var e=this.props.total;return 0!=this.props.total?s.a.createElement("div",null,s.a.createElement(S.a,{itemLayout:"vertical",size:"large",dataSource:this.props.itemList,renderItem:function(e){return s.a.createElement(P.b,{to:{pathname:"/detail",state:{movie:e}}},s.a.createElement(S.a.Item,{key:e._id},s.a.createElement(S.a.Item.Meta,{avatar:s.a.createElement("img",{width:150,src:e.poster,onError:"this.src='empty.png'"}),title:s.a.createElement("h1",null,e.title),description:s.a.createElement("div",null,s.a.createElement("span",null,s.a.createElement("span",null,e.pubdate[0]),s.a.createElement("span",null," / "),s.a.createElement("span",null,e.genres.join(" / "))),s.a.createElement("br",null),s.a.createElement("p",null,s.a.createElement(C.a,{disabled:!0,allowHalf:!0,defaultValue:5*e.rating.average/10-Math.floor(5*e.rating.average/10)>.5?Math.floor(5*e.rating.average/10)+.5:Math.floor(5*e.rating.average/10)}),s.a.createElement("span",{id:"score"},e.rating.average)," (\u8bc4\u8bba\u4eba\u6570\uff1a ",e.rating.rating_people,")"),s.a.createElement("p",{class:"summary"},e.summary))}),s.a.createElement(h.a,null)))}}),s.a.createElement(w.a,{showQuickJumper:!0,defaultCurrent:this.props.pageNum,total:e,onChange:this.onPageChange})):s.a.createElement("div",null)}}]),t}(i.Component);M.defaultProps={dataList:[]};var A={changePage:function(e){return{type:"PAGE",pageNum:e}},fetchData:N},J=M=Object(T.b)(function(e){return console.log("movie list mapStateToProps"),console.log(e),e},A)(M),x=function(e){function t(){var e;return Object(n.a)(this,t),e=Object(l.a)(this,Object(o.a)(t).call(this)),console.info("index constructor"),e.state={onSearch:!1,searchKeyword:"",total:0},e}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentWillMount",value:function(){console.info("index componentWillMount")}},{key:"componentDidMount",value:function(){console.info("index componentDidMount")}},{key:"shouldComponentUpdate",value:function(e,t){console.info("index shouldComponentUpdate");var a=1==t.onSearch&&t.searchKeyword!==this.state.searchKeyword;return console.log(a),a}},{key:"handleSubmitSearch",value:function(e,t){var a=0;switch(t){case"title":a=0;break;case"summary":a=1;break;case"actor":a=2;break;case"time":a=3}var n="http://47.107.167.12:8080/api/movies/search/keyword/"+e+"/type/"+a+"/page/";this.props.addSearchWord(n);var r=new Request(n+"1",{method:"GET"});this.props.fetchData(r),this.setState({onSearch:!0,searchKeyword:e})}},{key:"render",value:function(){return console.info("index render"),s.a.createElement(p.a,{color:"#fff"},s.a.createElement(j,{onSubmit:this.handleSubmitSearch.bind(this)}),s.a.createElement(J,null))}}]),t}(i.Component),G={addSearchWord:function(e){return{type:"SEARCH",basicPath:e}},fetchData:N},W=x=Object(T.b)(function(e){return e},G)(x),_=a(220),R=a(9),V=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(c)))).state={current:"home"},a.handleClick=function(e){if(console.log("click ",e),a.setState({current:e.key}),"home"==e.key){a.props.backToHomePage();var t=new Request("http://47.107.167.12:8080/api/movies/page/1",{method:"GET"});a.props.fetchData(t)}},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return s.a.createElement(_.b,{onClick:this.handleClick,selectedKeys:[this.state.current],mode:"horizontal"},s.a.createElement(_.b.Item,{key:"home"},s.a.createElement(P.b,{to:"/"},s.a.createElement(R.a,{type:"mail"}),"HomePage")),s.a.createElement(_.b.Item,{key:"analysis"},s.a.createElement(P.b,{to:"/analysis"},s.a.createElement(R.a,{type:"appstore"}),"AnalysisPage")))}}]),t}(i.Component),B={fetchData:N,backToHomePage:function(){return{type:"HOME",basicPath:"http://47.107.167.12:8080/api/movies/page/",pageNum:1}}},H=V=Object(T.b)(function(e){return e},B)(V),I=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(l.a)(this,Object(o.a)(t).call(this,e))).state={movie:a.props.location.state.movie},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state.movie;return s.a.createElement("div",null,s.a.createElement("p",{class:"pageTitle"},e.title),s.a.createElement("div",{class:"moviePoster"},s.a.createElement("span",null,s.a.createElement("img",{width:250,src:e.poster,onError:"this.src='empty.png'}"})),s.a.createElement("br",null)),s.a.createElement("div",{class:"introduction"},s.a.createElement("br",null),s.a.createElement("p",null,s.a.createElement("span",null,"\u53d1\u884c\u65f6\u95f4: ")," ",s.a.createElement("span",null,e.pubdate[0])),s.a.createElement("p",null,"\u56fd\u5bb6\uff1a",e.countries),s.a.createElement("p",null,"\u7c7b\u578b\uff1a",e.genres.join(" / ")),s.a.createElement("p",null,"\u5bfc\u6f14\uff1a",e.directors.map(function(e,t){return s.a.createElement("span",null," ",e.name," / ")})),s.a.createElement("p",null,"\u4e3b\u6f14\uff1a",e.casts.map(function(e,t){return s.a.createElement("span",null," ",e.name," / ")}))),s.a.createElement("div",{class:"ratingGroup"},s.a.createElement(C.a,{disabled:!0,defaultValue:5})," ",e.rating.stars[0],s.a.createElement("span",null,"%"),s.a.createElement("br",null),s.a.createElement(C.a,{disabled:!0,defaultValue:4})," ",e.rating.stars[1],s.a.createElement("span",null,"%"),s.a.createElement("br",null),s.a.createElement(C.a,{disabled:!0,defaultValue:3})," ",e.rating.stars[2],s.a.createElement("span",null,"%"),s.a.createElement("br",null),s.a.createElement(C.a,{disabled:!0,defaultValue:2})," ",e.rating.stars[3],s.a.createElement("span",null,"%"),s.a.createElement("br",null),s.a.createElement(C.a,{disabled:!0,defaultValue:1})," ",e.rating.stars[4],s.a.createElement("span",null,"%"),s.a.createElement("br",null)),s.a.createElement("div",null,s.a.createElement("p",null,"\u7b80\u4ecb\uff1a",e.summary)))}}]),t}(i.Component),F=(a(213),a(42)),U=a(20),q=a(129),K=a.n(q),z=function(e){function t(){var e;return Object(n.a)(this,t),e=Object(l.a)(this,Object(o.a)(t).call(this)),console.info("constructor"),e.state={dataList:{}},e}return Object(c.a)(t,e),Object(r.a)(t,[{key:"handleData",value:function(e){var t=e.replace(/[\b\f\r\t]/g,"").split("\n"),a=[];console.info(t.length);for(var n=0,r=t.length-1;n<r;n++){console.log(t[n]);var l;l=t[n].replace(/[\\]/g,""),console.log(l);try{var o=JSON.parse(l);a.push(o)}catch(c){console.info(n)}}return a}},{key:"getData",value:function(){var e=this;console.info("getData"),fetch("./films.json").then(function(e){return e.text()}).then(function(t){return e.setState({dataList:e.handleData(t)})})}},{key:"componentWillMount",value:function(){var e=this;console.info("analysis page componentWillMount");var t=new Request("http://47.107.167.12:8080/api/movies/analysis",{method:"GET"});fetch(t).then(function(e){return e.json()}).then(function(t){return e.setState({dataList:e.handleJson(t)})})}},{key:"handleJson",value:function(e){var t=[],a=[],n=[],r=e.countries,l=e.years,o=e.types;for(var c in r){var i={};i.country=c,i.num=r[c],t.push(i)}for(var c in l){(s={}).year=c,s.population=l[c],n.push(s)}for(var c in o){var s;(s={}).type=c,s.num=o[c],a.push(s)}return{country:t.sort(this.sortByField),year:n,type:a}}},{key:"sortByField",value:function(e,t){return e.num-t.num}},{key:"analyseData",value:function(){for(var e=[],t={},a=[],n={},r=[],l={"1970\u4e4b\u524d":0,"70\u5e74\u4ee3":0,"80\u5e74\u4ee3":0,"90\u5e74\u4ee3":0,"00\u5e74\u4ee3":0,"2010\u5e74\u4e4b\u540e":0},o=0,c=this.state.dataList.length;o<c;o++){for(var i=0,s=this.state.dataList[o].genres.length;i<s;i++)n.hasOwnProperty(this.state.dataList[o].genres[i])?n[this.state.dataList[o].genres[i]]+=1:n[this.state.dataList[o].genres[i]]=1;for(i=0,s=this.state.dataList[o].countries.length;i<s;i++)t.hasOwnProperty(this.state.dataList[o].countries[i])?t[this.state.dataList[o].countries[i]]+=1:t[this.state.dataList[o].countries[i]]=1;if(null!=this.state.dataList[o].pubdate[0]&&this.state.dataList[o].pubdate[0].length>2){var u=this.state.dataList[o].pubdate[0].substring(0,4);u<1970?l["1970\u4e4b\u524d"]+=1:u<1980?l["70\u5e74\u4ee3"]+=1:u<1990?l["80\u5e74\u4ee3"]+=1:u<2e3?l["90\u5e74\u4ee3"]+=1:u<2010?l["00\u5e74\u4ee3"]+=1:l["2010\u5e74\u4e4b\u540e"]+=1}}var m={country:"\u5176\u4ed6",num:0};for(var p in t){if(t[p]>3)(h={}).country=p,h.num=t[p],e.push(h);else m.num+=t[p]}for(var p in e.push(m),l){(h={}).year=p,h.population=l[p],r.push(h)}for(var p in n){var h;(h={}).type=p,h.num=n[p],a.push(h)}return{country:e.sort(this.sortByField),year:r,type:a}}},{key:"isEmptyJson",value:function(e){return"{}"==JSON.stringify(e)}},{key:"render",value:function(){if(this.isEmptyJson(this.state.dataList))return s.a.createElement("div",null);console.log(this.state.dataList);var e=this.state.dataList,t=e.country,a=e.year,n=e.type;return s.a.createElement("div",null,s.a.createElement(h.a,null,s.a.createElement("h1",{align:"center"},"\u56fd\u5bb6\u5206\u5e03")),s.a.createElement(X,{class:"Basic",data:t}),s.a.createElement(h.a,null,s.a.createElement("h1",{align:"center"},"\u5e74\u4efd\u5206\u5e03")),s.a.createElement(Q,{class:"Donutrose",data:a}),s.a.createElement(h.a,null,s.a.createElement("h1",{align:"center"},"\u7c7b\u578b\u5206\u5e03")),s.a.createElement(Y,{data:n}))}}]),t}(i.Component),X=function(e){function t(){return Object(n.a)(this,t),Object(l.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.data;console.log(e);var t=(new K.a).createView().source(e);return t.source(e).transform({type:"sort",callback:function(e,t){return!0}}),s.a.createElement("div",{class:"Basic"},s.a.createElement(U.Chart,{height:800,data:t,forceFit:!0},s.a.createElement(U.Coord,{transpose:!0}),s.a.createElement(U.Axis,{name:"country",label:{offset:12}}),s.a.createElement(U.Axis,{name:"num"}),s.a.createElement(U.Tooltip,null),s.a.createElement(U.Geom,{type:"interval",position:"country*num",color:"country"})))}}]),t}(s.a.Component),Q=function(e){function t(){return Object(n.a)(this,t),Object(l.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.data;return s.a.createElement("div",null,s.a.createElement(U.Chart,{height:400,data:e,forceFit:!0},s.a.createElement(U.Coord,{type:"polar",innerRadius:.2}),s.a.createElement(U.Tooltip,null),s.a.createElement(U.Legend,{position:"right",offsetY:-50,offsetX:-300}),s.a.createElement(U.Geom,{type:"interval",color:"year",position:"year*population",style:{lineWidth:1,stroke:"#fff"}})))}}]),t}(s.a.Component),Y=function(e){function t(){return Object(n.a)(this,t),Object(l.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.data;return s.a.createElement("div",null,s.a.createElement(U.Chart,{height:400,data:e,scale:{sales:{tickInterval:20}},forceFit:!0},s.a.createElement(U.Axis,{name:"type"}),s.a.createElement(U.Axis,{name:"num"}),s.a.createElement(U.Tooltip,{crosshairs:{type:"y"}}),s.a.createElement(U.Geom,{type:"interval",position:"type*num"})))}}]),t}(s.a.Component),Z=z,$=a(56),ee=a(130),te=function(e){function t(){return Object(n.a)(this,t),Object(l.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return s.a.createElement("main",null,s.a.createElement(F.c,null,s.a.createElement(F.a,{exact:!0,path:"/",component:W}),s.a.createElement(F.a,{path:"/analysis",component:Z}),s.a.createElement(F.a,{path:"/detail",component:I})))}}]),t}(i.Component),ae=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||$.c,ne=Object($.d)(function(e,t){if(!e)return{basicPath:"http://47.107.167.12:8080/api/movies/page/",pageNum:1,itemList:{},total:0};switch(t.type){case"HOME":return Object(L.a)({},e,{basicPath:t.basicPath,pageNum:t.pageNum});case"SEARCH":return Object(L.a)({},e,{basicPath:t.basicPath,pageNum:1});case"PAGE":return Object(L.a)({},e,{pageNum:t.pageNum});case"GET_DATA":return Object(L.a)({},e,{itemList:t.itemList,total:t.total});default:return e}},ae(Object($.a)(ee.a)));m.a.render(s.a.createElement(T.a,{store:ne},s.a.createElement(P.a,null,s.a.createElement(function(){return s.a.createElement("div",null,s.a.createElement(H,null),s.a.createElement(te,null),s.a.createElement(f,null))},null))),document.getElementById("root"))}},[[134,1,2]]]);
//# sourceMappingURL=main.f29cef58.chunk.js.map